## ChatGPT y programacion

![sumario](/imagenes/clase01/prepara_entorno/sumario.png)

![requisitos](/imagenes/clase01/prepara_entorno/requisitos.png)

### Preparando el entorno

- El enfoque de este curso será en la utilización de ChatGPT como herramienta de aprendizaje y automatización de tareas comunes en el día a día de una persona que trabaja con programación, independientemente del lenguaje, frameworks o tecnologías utilizadas.

Sin embargo, para que el curso sea práctico y realista, es decir, para que se acerque bastante a la realidad de una persona que trabaja con programación, utilizaremos un proyecto de una API Rest, ya desarrollado y que estará disponible a lo largo del curso.

Para que puedas ejecutarlo en tu computadora, será necesario realizar algunas instalaciones que detallaremos a continuación.

Observación importante: El proyecto del curso fue desarrollado en Java, pero no necesitas tener conocimientos del lenguaje, ya que el enfoque del curso no será en Java ni en las tecnologías del proyecto en sí, sino en la utilización de ChatGPT para asistencia en un proyecto de programación. A lo largo del curso se enseñará cómo descargar, ejecutar, explorar y modificar el proyecto.

### Instalación de Java

#### Linux

En la terminal, ejecutamos el siguiente comando para actualizar la lista de paquetes disponibles para descargar en los repositorios del sistema:

    sudo apt update

![alt text](/imagenes/clase01/prepara_entorno/image.png)

Una vez hecho esto, instalaremos la versión 17 del JDK mediante el siguiente comando:

    sudo apt install openjdk-17-jdk

![alt text](/imagenes/clase01/prepara_entorno/image-1.png)

De esta manera, el sistema descargará e instalará el paquete OpenJDK 17 JDK, lo que permitirá al usuario comenzar a desarrollar aplicaciones Java en Linux. Después de finalizar este proceso de instalación, ahora necesitamos configurar la variable de entorno JAVA_HOME, que se utiliza para indicar la ruta de instalación del JDK. Esto es necesario para utilizar los recursos del JDK, como javac.

Para ello, ejecutamos el comando sudo update-alternatives --config java, que mostrará la ruta donde se instaló el JDK.

![alt text](/imagenes/clase01/prepara_entorno/image-2.png)

Ahora, copiamos esta ruta hasta /bin, por ejemplo: /usr/lib/jvm/java-17-openjdk-amd64/bin, y en tu terminal escribe el comando: export JAVA_HOME= seguido de la ruta que copiaste de la instalación del JDK, sin dejar espacios.

Por ejemplo:

    export JAVA_HOME=/usr/lib/jvm/java-17-openjdk-amd64/bin

![alt text](/imagenes/clase01/prepara_entorno/image-3.png)

Presionamos la tecla "enter" y listo, el JDK está instalado y configurado. Para probarlo, escribe los siguientes comandos en la terminal:

    javac -version
    java -version

![alt text](/imagenes/clase01/prepara_entorno/image24.png)

#### Mac

1 - Para instalar en Mac, puedes acceder al sitio web de Oracle(Java Downloads | Oracle) o buscar en el navegador "Java Download Oracle" y acceder al primer enlace.

2 - Ahora, necesitamos elegir la versión de Java. En este curso utilizaremos Java 17 LTS, que es la versión de soporte a largo plazo más reciente para la plataforma Java SE.

![alt text](/imagenes/clase01/prepara_entorno/image-4.png)

3 - Selecciona Mac como sistema operativo y realiza la descarga.

![alt text](/imagenes/clase01/prepara_entorno/image-5.png)

#### Windows

1 - Para instalar en Windows, puedes acceder al sitio web de Oracle(Java Downloads | Oracle) o buscar en el navegador "Java Download Oracle" y acceder al primer enlace.

2 - Ahora, necesitamos elegir la versión de Java. En este curso utilizaremos Java 17 LTS, que es la versión de soporte a largo plazo más reciente para la plataforma Java SE.

![alt text](/imagenes/clase01/prepara_entorno/image-6.png)

3 - Selecciona Windows como sistema operativo y realiza la descarga.

![alt text](/imagenes/clase01/prepara_entorno/image-7.png)


4 - Una vez descargado, ejecuta el instalador y continúa con la instalación.

![alt text](/imagenes/clase01/prepara_entorno/image-8.png)

![alt text](/imagenes/clase01/prepara_entorno/image-9.png)

![alt text](/imagenes/clase01/prepara_entorno/image-10.png)


5 - Después de la instalación, vamos a probar nuestro Java. Para hacer esto, utilizaremos la ventana de comandos. Prueba los siguientes comandos y verifica si todo ha salido como se esperaba.

![alt text](/imagenes/clase01/prepara_entorno/image-11.png)

#### Configuración de la variable PATH en Windows:

1 - Ve al panel de control y busca "Sistema", luego haz clic en "Configuración avanzada del sistema".

![alt text](/imagenes/clase01/prepara_entorno/image-12.png)

2 - En la pestaña "Avanzado", haz clic en "Variables de entorno".

![alt text](/imagenes/clase01/prepara_entorno/image-13.png)

3 - Ahora se abrirá una nueva ventana en la parte inferior de la pantalla, selecciona la variable de entorno llamada "Path" y haz clic en "Editar".

![alt text](/imagenes/clase01/prepara_entorno/image-14.png)

En esta nueva ventana, haz clic en el botón "Nuevo" y en la línea que se ha seleccionado, coloca la ruta hacia el directorio "bin" dentro de la carpeta "jdk", que se encuentra dentro de la carpeta "Java".

![alt text](/imagenes/clase01/prepara_entorno/image-15.png)

5 - Una vez hecho esto, cierra la ventana de comandos y ábrela nuevamente. Prueba los siguientes comandos:

    java -version
    javac -version

## Instalación IntelliJ

Durante el curso, utilizaremos el IDE IntelliJ IDEA, desarrollado por la empresa JetBrains, conocida por desarrollar IDE’s y por ser la empresa que creó y mantiene uno de los lenguajes derivados de Java, Kotlin.

En esta preparación del ambiente, aprenderemos a instalar IntelliJ para facilitar el seguimiento del curso.

Para comenzar, debemos acceder a la página principal de IntelliJ, donde encontraremos algo similar a la imagen a continuación. Haga clic en el botón "Descargar":

![alt text](/imagenes/clase01/prepara_entorno/image-16.png)

Después de hacer clic, seremos dirigidos a la página de descargas de la herramienta, que ofrece opciones para los sistemas operativos Windows, Linux y MacOS veremos dos opciones de descarga que corresponden a las dos versiones del IDE: la edición Ultimate y la Community.

La versión Ultimate ofrece más funciones, como soporte para más lenguajes y administración de bases de datos integrada, pero es de pago. La edición Community es la opción gratuita de la herramienta y cuenta con todas las funciones que necesitaremos durante el curso, por lo tanto, instalaremos esta versión.

Para descargar IntelliJ Community Edition, haremos clic en el botón "Descargar" como se muestra en la imagen a continuación:

![alt text](/imagenes/clase01/prepara_entorno/image-17.png)


Después de hacer clic en "Descargar", se descargará la herramienta y la instalación variará según el sistema operativo.

### Windows

En Windows, se descargará el instalador de la herramienta con un nombre similar a "ideaIC-2022.3.2", dependiendo de la versión descargada. Para iniciar la instalación, ejecutaremos ese archivo.

Una vez ejecutado, se abrirá una ventana del instalador estándar de Windows, como se muestra en la imagen a continuación, donde haremos clic en el botón "Next":

![alt text](/imagenes/clase01/prepara_entorno/image-18.png)

Esto nos llevará a una página donde seleccionaremos en qué carpeta se realizará la instalación. Aquí podemos dejarlo en el directorio predeterminado y nuevamente hacer clic en el botón "Next", como se muestra a continuación:

![alt text](/imagenes/clase01/prepara_entorno/image-19.png)

Después de eso, seremos dirigidos a una pantalla con varias casillas de verificación que corresponden a opciones de instalación de la herramienta. Estas opciones incluyen si deseamos crear un acceso directo en el escritorio, agregar IntelliJ al PATH para que pueda ser accedido desde la línea de comandos, agregar una nueva acción al menú contextual para que al hacer clic derecho en un archivo aparezca la opción de abrirlo en IntelliJ, y asociar tipos de archivo para que se abran directamente en la IDE.

Aquí podemos seleccionar todas las casillas, como se muestra en la imagen:

![alt text](/imagenes/clase01/prepara_entorno/image-20.png)

Si no deseas marcar todas las casillas, la más importante se encuentra en la pestaña "Create Associations" (Crear Asociaciones), donde crearemos las asociaciones de los archivos .java con IntelliJ, como se resalta en la imagen anterior. Después de seleccionar las opciones deseadas, podemos continuar haciendo clic en el botón "Next" (Siguiente).

Luego, pasamos a la selección de la carpeta del menú de inicio donde ubicaremos nuestra IDE. En esta pantalla, simplemente podemos dejar la opción predeterminada y hacer clic en el botón "Install" (Instalar) para instalar la herramienta en nuestra computadora, como se muestra a continuación:

![alt text](/imagenes/clase01/prepara_entorno/image-21.png)

Se iniciará la instalación de los archivos de la herramienta, lo cual puede llevar algún tiempo. ¡Es hora de tomar un café y esperar!

Al finalizar la instalación, se nos dirigirá a una pantalla con la opción de reiniciar la computadora ahora o después. Se recomienda reiniciar la computadora para que los cambios en el PATH funcionen correctamente, aunque la herramienta ya se puede utilizar incluso sin reiniciar.

Por último, podemos hacer clic en el botón "Finish" (Finalizar) para finalizar el instalador, como se muestra en la siguiente imagen:

alt: Imagen de una captura de pantalla del instalador de IntelliJ en la pantalla de finalización de la instalación. Se muestran información sobre la instalación y dos casillas de verificación centradas, de arriba a abajo: "Reboot now" (Reiniciar ahora) y "I want to manually reboot later" (Quiero reiniciar manualmente más tarde). La primera opción está seleccionada. En la esquina inferior derecha hay tres botones, de derecha a izquierda: "cancel" (cancelar), "Finish" (Finalizar) y "Back" (Atrás), con énfasis en el botón del centro.

![alt text](/imagenes/clase01/prepara_entorno/image-22.png)

¡Y listo! IntelliJ ya puede ser utilizado para desarrollar tus aplicaciones.

### Linux
En los sistemas Linux, el archivo descargado es un archivo comprimido con el IDE preinstalado. Para poder ejecutarlo, debemos navegar a la carpeta donde se encuentra el archivo descargado y descomprimirlo con el comando:

    tar -xf <archivo descargado>.tar.gz

El nombre del archivo puede variar según la versión descargada, pero siempre sigue un patrón como "ideaIC-2022.3.2.tar".

Después de descomprimir el archivo, se creará una carpeta con un nombre similar a "idea-IC-xxx.xxx.xx" donde las "x" representan la versión de la herramienta. Para abrir el IDE, es necesario navegar a la carpeta, usando el comando:

    cd idea-IC-xxx.xxx.xx

Y acceda a la subcarpeta "bin", desde el comando:

    cd bin

Dónde se encuentra el archivo "idea.sh", que es el script de inicio de IntelliJ. Ahora, para abrir el IDE, simplemente ejecute el script con el comando:

    ./idea.sh

¡Eso inicializará la herramienta que ya está lista para ser utilizada!

### macOS

En macOS, al igual que en Windows, se descarga un instalador con la extensión ".dmg" y la instalación es bastante sencilla.

Para ello, navegaremos hasta la carpeta de descargas del archivo y lo ejecutaremos haciendo doble clic. Se abrirá una ventana que solicitará arrastrar el ícono de IntelliJ hacia el ícono de la carpeta Applications (Aplicaciones), como se muestra en la siguiente imagen:

![alt text](/imagenes/clase01/prepara_entorno/image-23.png)

alt: Captura de pantalla de la ventana abierta después de ejecutar el archivo de instalación. Se muestra un ícono de la herramienta IntelliJ centrado a la izquierda, seguido del texto "dragTo" (arrastrar hacia) que apunta al ícono de la carpeta "Applications" (Aplicaciones) del sistema.

Después de arrastrarlo, comenzará el proceso de copia de archivos y se instalará la IDE. Al finalizar la instalación, simplemente buscaremos en el menú de búsqueda por "IntelliJ" y ejecutaremos el programa "IntelliJ IDEA CE" para acceder a las funciones de la herramienta.

### Instalación de Postman

Utilizaremos Postman como herramienta para pruebas de la API. Si no lo tienes instalado en tu computadora, Postman: aprenda cómo instalar y dar sus primeros pasos sobre cómo realizar la instalación de Postman.
link: https://www.aluracursos.com/blog/postman-aprenda-como-instalar-y-dar-sus-primeros-pasos

### Instalación de MySQL

Utilizaremos MySQL como base de datos de la aplicación. Si no lo tienes instalado en tu computadora, MySQL: desde la descarga e instalación hasta su primera tabla sobre cómo realizar la instalación de MySQL.
link: https://www.aluracursos.com/blog/mysql-desde-la-descarga-e-instalacion-hasta-su-primera-tabla




# Preparando la aplicacion en JAVA

Preparando el ambiente: proyecto del curso

Después de la instalación de Java, IntelliJ, Postman y MySQL, ya podemos descargar y configurar el proyecto del curso.

Link del proyecto: https://github.com/alura-cursos/2096-ChatGPT-y-programacion-aumenta-tu-productividad

El proyecto inicial del curso debe ser descargado y descomprimido en algún directorio de tu computadora.

Después de eso, importa el proyecto en IntelliJ haciendo clic en el botón "Open" (o desde el menú superior File -> Open…) y eligiendo el directorio en el cual lo descomprimiste.

![app java](/imagenes/clase01/app_java/image.png)

Pantalla inicial de IntelliJ después de importar el proyecto del curso. A la izquierda de la pantalla, en la pestaña "project", debe aparecer la estructura de archivos y directorios del proyecto.

El siguiente paso será importar en Postman las solicitudes que se enviarán para realizar las pruebas en la API.

Descarga los archivos JSON de las solicitudes y descomprime el zip en algún directorio de tu computadora.

Ahora, en la pantalla inicial de Postman, haz clic en el menú superior File y elige la opción Import…

![alt text](/imagenes/clase01/app_java/image-1.png)

Pantalla inicial de importación de archivos en Postman.

En la ventana que se abrió, haz clic en el botón Upload Files y elige todos los archivos .json descargados.

![alt text](/imagenes/clase01/app_java/image-2.png)

Pantalla de importación en Postman listando los archivos seleccionados.

Haz clic en el botón Import para realizar la importación y debería aparecer la siguiente pantalla:

Pantalla principal de Postman con las colecciones de solicitudes importadas.

![alt text](/imagenes/clase01/app_java/image-3.png)

¡Listo! A continuación, veremos cómo ejecutar la aplicación y explorar sus funcionalidades, enviando solicitudes a través de Postman.

## Se hace un Fork del repositorio de Genesys.

![alt fork_genesys](/imagenes/clase01/app_java/fork_genesys.png)

- da error por conexion a la base de datos mysql


![alt error_mysql](/imagenes/clase01/app_java/error_mysql.png)

- Se descomprime el archivo que contiene los JSOn para configurar Postman, esta el carapeta de recursos
- 

![alt postman_configurado](/imagenes/clase01/app_java/postman_1.png)

![alt postman_2](/imagenes/clase01/app_java/postman_2.png)


## Identificando un BUG

aplicacion lista en intellij

![alt aplicacion_1](/imagenes/clase01/app_java/aplicacion_1.png)

- creando las variables de entorno del server, usuario y clave

![alt aplicacion_2](/imagenes/clase01/app_java/aplicacion_2.png)

- Verificacion de la migracion y creacion de las tablas en la BD en MySQL

![alt bd_1](/imagenes/clase01/app_java/bd_1.png)

- verificando con postman que se puede registrar un paciente

![alt registra_paciente_1](/imagenes/clase01/app_java/registra_paciente_1.png)

En el curso se muestra que el dato complemento se guarda como null, ese es un bug.
En mi caso el repositorio forkeado no presenta ese error

En la consulta prompt con chatgpt se entrega:

- El error de guardar el dato complemento con null
- Que se esta usando java con spring boot
- el codigo del controlador pacientecontroller, solo el metodo registrar
- el codigo del dto datosregistropaciente 
- el codigo del dto datosdireccion

en el curso chatgpt inidica que el error es que en datosdireccion el nombre esta complemeto y debe ser complemento. alli esta el error de sintaxys

** muy interesante ** no cambia el nombre directo en el codigo, sino con boton derecho hace una refactorizacion para cambiar el codigo y asi estar tranquilos que si se esta usando en otra parte del codigo esto se actualiza. refactor-> rename

![alt refactor_reaname](/imagenes/clase01/app_java/refactor_rename.png)

## Entendiendo un codigo

primero registramos un medico:

![alt registra_medico](/imagenes/clase01/app_java/registra_medico.png)

luego ejecutamos marcar consulta:

![alt marcar_consulta](/imagenes/clase01/app_java/marcar_consulta.png)

ahora preguntemos a chatgpt como funciona el codigo en el controlador de consultas de agendar:

    "explicarme como funciona este codigo:  @PostMapping
    @Transactional
    public ResponseEntity agendar(@RequestBody @Valid DatosAgendarConsulta datos) throws ValidacionDeIntegridad {
        var response = service.agendar(datos);
        return ResponseEntity.ok(response);
    }"

    Respuesta:

    Vamos a analizar lo que hace este código línea por línea:

        ### 1. `@PostMapping`
        Esta anotación indica que este método manejará las solicitudes HTTP POST que se envíen a la URL mapeada a este controlador. En Spring Boot, cada controlador puede manejar varios tipos de solicitudes HTTP (GET, POST, PUT, DELETE, etc.) y `@PostMapping` especifica que este método es para solicitudes POST.

        ### 2. `@Transactional`
        Esta anotación se utiliza para indicar que el método debe ser ejecutado dentro de una transacción. Si algo falla dentro del método, se hará un rollback (deshacer) de todas las operaciones realizadas en la base de datos durante esa transacción. Es útil para asegurar la consistencia de los datos.

        ### 3. `public ResponseEntity agendar(@RequestBody @Valid DatosAgendarConsulta datos) throws ValidacionDeIntegridad`
        Este es el método controlador que se ejecutará cuando se reciba una solicitud POST. Desglosemos sus partes:

        - **`public ResponseEntity agendar(...)`**: Define un método público que devuelve un objeto de tipo `ResponseEntity`. `ResponseEntity` es una clase que representa una respuesta HTTP, incluyendo el cuerpo de la respuesta, el estado HTTP, y los encabezados.
        
        - **`@RequestBody`**: Esta anotación indica que el parámetro `datos` debe ser deserializado desde el cuerpo de la solicitud HTTP. Esto significa que cuando un cliente envía un JSON en el cuerpo de la solicitud, Spring lo convierte automáticamente en un objeto `DatosAgendarConsulta`.

        - **`@Valid`**: Esta anotación se usa para activar la validación de los datos de entrada. Utiliza las anotaciones de validación (como `@NotNull`, `@Size`, etc.) que puedas haber definido en la clase `DatosAgendarConsulta`. Si los datos no pasan la validación, se lanza una excepción.

        - **`DatosAgendarConsulta datos`**: Este es el objeto que contiene los datos enviados por el cliente para agendar una consulta. Es el tipo del parámetro que será deserializado del cuerpo de la solicitud.

        - **`throws ValidacionDeIntegridad`**: Esto indica que el método puede lanzar una excepción de tipo `ValidacionDeIntegridad` si ocurre un error específico de validación de integridad durante la ejecución.

        ### 4. `var response = service.agendar(datos);`
        Aquí se llama al método `agendar` del servicio (probablemente un componente de servicio de negocio de tu aplicación) y se pasa el objeto `datos` como argumento. La variable `response` almacenará el resultado devuelto por este servicio. Usar `var` es solo una forma de inferir el tipo de la variable automáticamente.

        ### 5. `return ResponseEntity.ok(response);`
        Finalmente, el método devuelve una respuesta HTTP con un estado 200 OK (que indica que la solicitud fue exitosa) y en el cuerpo de la respuesta se incluye el objeto `response`.

        ### Resumen
        Este método en el controlador maneja una solicitud HTTP POST que agenda una consulta. Los datos enviados en el cuerpo de la solicitud se validan y, si son correctos, se pasa a un servicio que gestiona la lógica para agendar la consulta. Si todo va bien, se devuelve una respuesta HTTP con el resultado.


